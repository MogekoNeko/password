<!DOCTYPE html>
<html>
<head>
  <title>Nueva Contraseña - Acceso SASA</title>
  <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
</head>
<body>
  <div class="card">
    <h2>Establece tu nueva contraseña</h2>
    <form id="updatePasswordForm">
      <input type="password" id="newPassword" placeholder="Nueva contraseña" required>
      <input type="password" id="confirmPassword" placeholder="Confirmar contraseña" required>
      <button type="submit">Actualizar</button>
    </form>
    <div id="message"></div>
  </div>

  <script>
    const supabase = supabase.createClient(
      'https://xfbmdpxyeombmwqhfzug.supabase.co', 
      'TU_KEY_PUBLICO_SUPABASE'
    )

    document.getElementById('updatePasswordForm').addEventListener('submit', async (e) => {
      e.preventDefault()
      
      const newPassword = document.getElementById('newPassword').value
      const confirmPassword = document.getElementById('confirmPassword').value
      
      if(newPassword !== confirmPassword) {
        document.getElementById('message').innerHTML = 'Las contraseñas no coinciden'
        return
      }

      try {
        const { error } = await supabase.auth.updateUser({
          password: newPassword
        })
        
        if(error) throw error
        
        document.getElementById('message').innerHTML = '¡Contraseña actualizada con éxito!'
      } catch(error) {
        document.getElementById('message').innerHTML = `Error: ${error.message}`
      }
    })
  </script>
</body>
</html>
